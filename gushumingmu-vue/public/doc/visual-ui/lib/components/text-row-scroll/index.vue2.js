"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("vue"),d=require("lodash"),V=require("vue3-seamless-scroll"),f=require("nanoid"),M=require("../../commons/plugins/datasource/index.js"),u=require("../../commons/plugins/event/index.js"),q=["onClick","onMouseenter","onMouseout"],D=["onClick"],W={key:1},H=o.defineComponent({name:"zv-text-row-scroll"}),J=o.defineComponent({...H,props:{basicOption:{},useEvents:{},sources:{},uuid:{}},emits:["on-click-item","on-click-row","on-mouseenter-row","on-mouseout-row"],setup(O,{expose:y,emit:g}){o.useCssVars(e=>({"1ecf4d84":e.basicOption.css.table.borderWidth+"px",d92d3a58:e.basicOption.css.table.borderStyle,daf516f4:e.basicOption.css.table.borderColor,"413c0106":e.basicOption.css.table.paddingLeft+"px","379313ec":e.basicOption.css.table.alignItems,ed7e110c:e.basicOption.css.table.justifyContent,"39d7a73e":e.basicOption.css.header.background,"1f2d0176":e.basicOption.css.header.height+"px","08fe595a":e.basicOption.css.header.color,"28eb118d":e.basicOption.css.header.fontSize+"px","5d78d5b7":e.basicOption.css.header.fontWeight,"0b14a692":e.basicOption.css.header.fontStyle,e3a9ffea:e.basicOption.css.body.height+"px","452338c9":e.basicOption.css.body.background,"7a020f4c":e.basicOption.css.oddBackground,b8859230:e.basicOption.css.body.color,"5f38823c":e.basicOption.css.body.fontSize+"px","68c46742":e.basicOption.css.body.fontWeight,"9ec990b2":e.basicOption.css.body.fontStyle}));const p=g,m=o.ref(f.nanoid()),l=o.ref([]),s=O,b=o.ref(s.basicOption.scroll.start),a=()=>{M.SHJDatasourceV2.parse({tId:s.uuid,sources:s.sources,callback:e=>{try{u.SHJParseEvent.parseEvents(s.useEvents,"dataListener",l),l.value=d.cloneDeep(e.data[0].data)||[],m.value=f.nanoid(),b.value=s.basicOption.scroll.start}catch{u.SHJParseEvent.parseEvents(s.useEvents,"dataListener",null),l.value=[],m.value=f.nanoid(),b.value=s.basicOption.scroll.start}}})},E=e=>{const t=[];for(const n in e)t.push(e[n]);return t};o.onMounted(()=>a()),o.watch(()=>d.cloneDeep(s.basicOption),(e,t)=>{d.isEqual(e,t)||a()},{deep:!0}),o.watch(()=>d.cloneDeep(s.sources),(e,t)=>{d.isEqual(e,t)||a()},{deep:!0}),y({refresh:()=>a(),refreshView:()=>a(),refreshData:()=>a()});const w=e=>{if(!s.basicOption.columns)return!0;const t=s.basicOption.columns.find(n=>n.index===e);return t?t.font.auto:!0},h=e=>{if(!s.basicOption.columns)return null;const t=s.basicOption.columns.find(n=>n.index===e);return t&&t.font.auto===!1?t.font:null},v=e=>{if(!s.basicOption.columns)return!0;const t=s.basicOption.columns.find(n=>n.index===e);return t?t.width.auto:!0},k=e=>{if(!s.basicOption.columns)return null;const t=s.basicOption.columns.find(n=>n.index===e);return t&&t.width.auto===!1?t.width.width:null},S=(e,t)=>{const n={row:e,rowIndex:t};p("on-click-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-click-row",n)},C=(e,t)=>{const n={row:e,rowIndex:t};p("on-mouseenter-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-mouseenter-row",n)},B=(e,t)=>{const n={row:e,rowIndex:t};p("on-mouseout-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-mouseout-row",n)},z=(e,t,n,i)=>{const r={row:e,item:t,rowIndex:n,columnIndex:i};p("on-click-item",r),u.SHJParseEvent.parseEvents(s.useEvents,"on-click-item",r)};return(e,t)=>l.value.length>0?(o.openBlock(),o.createElementBlock("div",{key:m.value,class:"table-scroll"},[e.basicOption.css.header.show?(o.openBlock(),o.createElementBlock("div",{key:0,class:"table-header",style:o.normalizeStyle({"--header-background-image":`url(${e.basicOption.css.header.backgroundImage})`})},[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(Object.keys(l.value[0]),(n,i)=>(o.openBlock(),o.createElementBlock("div",{key:n,class:o.normalizeClass(["th",{customWidth:!v(i+1)}]),style:o.normalizeStyle({"--width":k(i+1)+"px"})},[o.createElementVNode("p",null,o.toDisplayString(n),1)],6))),128))],4)):o.createCommentVNode("",!0),o.createVNode(o.unref(V.Vue3SeamlessScroll),{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=n=>b.value=n),direction:e.basicOption.scroll.direction,list:l.value,"is-watch":"",hover:e.basicOption.scroll.hover,"limit-scroll-num":e.basicOption.scroll.limitScrollNum,"single-height":e.basicOption.scroll.isSingle?e.basicOption.css.body.height:0,"single-wait-time":e.basicOption.scroll.singleWaitTime,class:"table-body"},{default:o.withCtx(()=>[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.value,(n,i)=>(o.openBlock(),o.createElementBlock("div",{key:n,class:"tr",style:o.normalizeStyle({"--row-hover":e.basicOption.css.hoverColor}),onClick:r=>S(n,i),onMouseenter:r=>C(n,i),onMouseout:r=>B(n,i)},[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(E(n),(r,c)=>(o.openBlock(),o.createElementBlock("div",{key:r,class:o.normalizeClass(["td",{customWidth:!v(c+1)}]),style:o.normalizeStyle({"--width":k(c+1)+"px"}),onClick:P=>z(n,r,i,c)},[w(c+1)?(o.openBlock(),o.createElementBlock("p",W,o.toDisplayString(r),1)):(o.openBlock(),o.createElementBlock("p",{key:0,class:"customFont",style:o.normalizeStyle({"--text-color":h(c+1).color,"--text-font-size":h(c+1).fontSize+"px","--text-font-style":h(c+1).fontStyle})},o.toDisplayString(r),5))],14,D))),128))],44,q))),128))]),_:1},8,["modelValue","direction","list","hover","limit-scroll-num","single-height","single-wait-time"])])):o.createCommentVNode("",!0)}});exports.default=J;
