"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),c=require("lodash"),h=require("nanoid"),q=require("../../commons/plugins/datasource/index.js"),i=require("../../commons/utils/json2css.js"),a=require("../../commons/plugins/event/index.js"),M=["type","placeholder"],_=n.defineComponent({name:"zv-interaction-input"}),C=n.defineComponent({..._,props:{basicOption:{},sources:{},useEvents:{},uuid:{}},emits:["on-blur","on-focus","on-input","on-change"],setup(E,{expose:y,emit:m}){const o=E,l=m,S=()=>{const e=n.ref(""),s=n.ref(),v=u=>{if(i.autoInstallFont(u.fontFamily),i.autoInstallFont(u.focus.fontFamily),s.value)return{...i.jsonToCssStyle(u),...i.jsonToCssStyle(u.focus,"focus"),...i.jsonToCssStyle(u.placeholder,"placeholder")}},d=n.ref(),f=()=>{q.SHJDatasourceV2.parse({tId:o.uuid,sources:o.sources,callback:({data:u})=>{try{a.SHJParseEvent.parseEvents(o.useEvents,"dataListener",u),d.value=h.nanoid(),e.value=u[0].data[0].value}catch{a.SHJParseEvent.parseEvents(o.useEvents,"dataListener",null),d.value=h.nanoid()}}})};return n.onMounted(()=>f()),{key:d,init:f,rendererDomStyle:v,inputRef:s,inputValue:e}},{key:b,init:r,rendererDomStyle:I,inputRef:t,inputValue:p}=S(),w=e=>{t.value&&(l("on-blur",e,t.value.value),a.SHJParseEvent.parseEvents(o.useEvents,"on-blur",{data:t.value.value,event:e}))},D=e=>{t.value&&(l("on-focus",e,t.value.value),a.SHJParseEvent.parseEvents(o.useEvents,"on-focus",{data:t.value.value,event:e}))},g=e=>{t.value&&(l("on-input",e,t.value.value),a.SHJParseEvent.parseEvents(o.useEvents,"on-input",{data:t.value.value,event:e}))},k=e=>{t.value&&(l("on-change",e,t.value.value),a.SHJParseEvent.parseEvents(o.useEvents,"on-change",{data:t.value.value,event:e}))};return n.watch(()=>c.cloneDeep(o.basicOption),(e,s)=>{c.isEqual(e,s)||r()},{deep:!0}),n.watch(()=>c.cloneDeep(o.sources),(e,s)=>{c.isEqual(e,s)||r()},{deep:!0}),y({refresh:()=>r(),refreshView:()=>r(),refreshData:()=>r()}),(e,s)=>n.withDirectives((n.openBlock(),n.createElementBlock("input",{"onUpdate:modelValue":s[0]||(s[0]=v=>n.isRef(p)?p.value=v:null),key:n.unref(b),ref_key:"inputRef",ref:t,type:e.basicOption.css.type||"text",class:"zerov-widget-input",placeholder:e.basicOption.placeholderValue,style:n.normalizeStyle(n.unref(I)(e.basicOption.css)),onBlur:n.withModifiers(w,["stop"]),onFocus:n.withModifiers(D,["stop"]),onInput:n.withModifiers(g,["stop"]),onChange:n.withModifiers(k,["stop"])},null,44,M)),[[n.vModelDynamic,n.unref(p)]])}});exports.default=C;
