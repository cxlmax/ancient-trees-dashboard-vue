"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),s=require("lodash"),i=require("dayjs");require("dayjs/locale/zh-cn");const d=require("../../commons/utils/json2css.js"),f=require("../../commons/plugins/event/index.js"),T=["ztitle"],_=t.defineComponent({name:"zv-text-real-time"}),b=t.defineComponent({..._,props:{basicOption:{},datasource:{},useEvents:{}},emits:["on-change"],setup(m,{emit:v}){const u=v,r=m,p=o=>{const n=t.ref(),a=t.ref(i().locale("zh-cn").format(o.format)),g=e=>{d.autoInstallFont(e.fontFamily);const l={};e.color&&e.color.includes("linear-gradient")&&(l.backgroundImage=e.color,l["-webkit-background-clip"]="text",l.color="transparent");const S={};return e.textAlign==="left"&&(e.justifyContent="flex-start"),e.textAlign==="center"&&(e.justifyContent="center"),e.textAlign==="right"&&(e.justifyContent="flex-end"),{...d.jsonToCssStyle(e),...l,...S,...e.textShadow.show?{"--text-shadow":`${e.textShadow.x}px ${e.textShadow.y}px ${e.textShadow.value}px ${e.textShadow.color}`}:{}}},y=e=>{n.value&&clearInterval(n.value),n.value=setInterval(()=>{a.value=i().locale("zh-cn").format(e),u("on-change",a.value),f.SHJParseEvent.parseEvents(r.useEvents,"on-change",a.value)},1e3)};return t.onMounted(()=>{n.value=setInterval(()=>{a.value=i().locale("zh-cn").format(o.format),u("on-change",a.value),f.SHJParseEvent.parseEvents(r.useEvents,"on-change",a.value)},1e3)}),t.onBeforeUnmount(()=>{n.value&&clearInterval(n.value)}),{updateRealTime:y,realTime:a,rendererDomStyle:g}},{updateRealTime:h,realTime:c,rendererDomStyle:x}=p(r.basicOption);return t.watch(()=>s.cloneDeep(r.basicOption.format),(o,n)=>{s.isEqual(o,n)||h(o)},{deep:!0}),(o,n)=>(t.openBlock(),t.createElementBlock("div",{class:"real-time",style:t.normalizeStyle(t.unref(x)(o.basicOption.css)),ztitle:t.unref(c)},t.toDisplayString(t.unref(c)),13,T))}});exports.default=b;
