"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),v=require("hls.js"),u=require("lodash"),s=require("../../commons/plugins/event/index.js"),O=["poster","autoplay","controls","loop","muted"],H=t.defineComponent({name:"zv-media-m3u8"}),M=t.defineComponent({...H,props:{basicOption:{},sources:{},useEvents:{}},emits:["on-video-progress","on-video-play","on-video-pause","on-video-ended","on-video-playing","on-video-timeupdate","on-video-error","on-video-volumechange"],setup(p,{expose:l,emit:c}){const o=p,E=()=>{const e=t.ref(),a=r=>{if(r)if(v.isSupported()){const d=new v;d.loadSource(r),d.attachMedia(e.value),d.on(v.Events.MANIFEST_PARSED,()=>{o.basicOption.autoplay&&e.value.play()})}else e.value.canPlayType("application/vnd.apple.mpegurl")&&(e.value.src=r)};return t.onMounted(()=>a(o.basicOption.src)),{videoRef:e,initM3u8Video:a}},{videoRef:i,initM3u8Video:m}=E();t.watch(()=>u.cloneDeep(o.basicOption),(e,a)=>{u.isEqual(e,a)||m(e.src)},{deep:!0});const n=c,y=()=>{n("on-video-progress"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-progress")},f=()=>{n("on-video-play"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-play")},P=()=>{n("on-video-pause"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-pause")},g=()=>{n("on-video-ended"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-ended")},S=()=>{n("on-video-playing"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-playing")},V=()=>{n("on-video-timeupdate"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-timeupdate")},b=()=>{n("on-video-error"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-error")},h=()=>{n("on-video-volumechange"),s.SHJParseEvent.parseEvents(o.useEvents,"on-video-volumechange")};return l({play:()=>{i.value&&i.value.play()},pause:()=>{i.value&&i.value.pause()}}),(e,a)=>(t.openBlock(),t.createElementBlock("video",{ref_key:"videoRef",ref:i,class:"zerov-widget",poster:e.basicOption.poster,autoplay:e.basicOption.autoplay,controls:e.basicOption.controls,loop:e.basicOption.loop,muted:e.basicOption.muted,onProgress:y,onPlay:f,onEnded:g,onPlaying:S,onPause:P,onTimeupdate:V,onError:b,onVolumechange:h},null,40,O))}});exports.default=M;
