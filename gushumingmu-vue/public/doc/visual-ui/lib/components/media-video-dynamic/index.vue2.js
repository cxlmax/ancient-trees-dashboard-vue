"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("vue"),b=require("nanoid"),v=require("lodash"),k=require("../../commons/plugins/datasource/index.js"),s=require("../../commons/plugins/event/index.js"),_=["poster","autoplay","controls","loop","muted","src"],O=o.defineComponent({name:"zv-media-video-dynamic"}),q=o.defineComponent({...O,props:{basicOption:{},sources:{},useEvents:{},uuid:{}},emits:["on-video-progress","on-video-play","on-video-pause","on-video-ended","on-video-playing","on-video-timeupdate","on-video-error","on-video-volumechange"],setup(c,{expose:p,emit:l}){const e=c,E=()=>{const n=o.ref(""),a=o.ref(b.nanoid()),d=()=>{k.SHJDatasourceV2.parse({tId:e.uuid,sources:e.sources,callback:({data:u})=>{try{s.SHJParseEvent.parseEvents(e.useEvents,"dataListener",u),n.value=u[0].data[0].src}catch{s.SHJParseEvent.parseEvents(e.useEvents,"dataListener",null)}}})};return o.onMounted(()=>o.nextTick(()=>d())),{init:d,src:n,key:a}},{init:i,src:m,key:y}=E();o.watch(()=>v.cloneDeep(e.sources),(n,a)=>{v.isEqual(n,a)||i()},{deep:!0});const r=o.ref(),t=l,f=()=>{t("on-video-progress"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-progress")},P=()=>{t("on-video-play"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-play")},g=()=>{t("on-video-pause"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-pause")},h=()=>{t("on-video-ended"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-ended")},S=()=>{t("on-video-playing"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-playing")},V=()=>{t("on-video-timeupdate"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-timeupdate")},H=()=>{t("on-video-error"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-error")},J=()=>{t("on-video-volumechange"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-volumechange")};return p({play:()=>{r.value&&r.value.play()},pause:()=>{r.value&&r.value.pause()},refresh:()=>i(),refreshView:()=>i(),refreshData:()=>i()}),(n,a)=>(o.openBlock(),o.createElementBlock("video",{ref_key:"videoRef",ref:r,key:o.unref(y),poster:n.basicOption.poster,autoplay:n.basicOption.autoplay,controls:n.basicOption.controls,loop:n.basicOption.loop,muted:n.basicOption.muted,class:"zerov-widget-video",src:o.unref(m),onProgress:f,onPlay:P,onEnded:h,onPlaying:S,onPause:g,onTimeupdate:V,onError:H,onVolumechange:J},null,40,_))}});exports.default=q;
