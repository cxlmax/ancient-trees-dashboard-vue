"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const a=require("vue"),i=require("lodash"),w=require("nanoid"),B=require("../../commons/plugins/datasource/index.js"),S=require("../../commons/core/earth/main.vue.js"),c=require("../../commons/core/earth/border.vue.js"),d=require("../../commons/plugins/event/index.js"),_={class:"zerov-widget"},C=["id"],E=a.defineComponent({name:"zv-map-earth-particle"}),x=a.defineComponent({...E,props:{basicOption:{},sources:{},useEvents:{},uuid:{}},emits:["on-success"],setup(h,{expose:m,emit:k}){const f=k,t=h,g=w.nanoid(),s=a.ref(),v=a.ref(!0),e=a.ref(i.cloneDeep(t.basicOption)),l=i.debounce((o=!1)=>{v.value=!0,e.value=i.cloneDeep(t.basicOption),t.sources&&t.sources.length>0?B.SHJDatasourceV2.parse({tId:t.uuid,sources:t.sources,callback:r=>{try{d.SHJParseEvent.parseEvents(t.useEvents,"dataListener",r.data);const u=e.value.lines&&e.value.lines.find(n=>n._sourceId===r.id);u&&(u.data=r.data[0].data);const p=e.value.flylines&&e.value.flylines.find(n=>n._sourceId===r.id);p&&(p.data=r.data[0].data);const y=e.value.lightBeams&&e.value.lightBeams.find(n=>n._sourceId===r.id);y&&(y.data=r.data[0].data),!o&&s.value.refresh()}catch{d.SHJParseEvent.parseEvents(t.useEvents,"dataListener",null)}}}):!o&&s.value.refresh()},200);a.onMounted(()=>l(!0)),a.watch(()=>i.cloneDeep(t.basicOption),(o,r)=>{i.isEqual(o,r)||l()},{deep:!0}),a.watch(()=>i.cloneDeep(t.sources),(o,r)=>{i.isEqual(o,r)||l()},{deep:!0}),m({refresh:()=>l(),refreshView:()=>l(),refreshData:()=>l()});const b=()=>{v.value=!1,f("on-success"),d.SHJParseEvent.parseEvents(t.useEvents,"on-success",null)};return(o,r)=>(a.openBlock(),a.createElementBlock("div",_,[a.createElementVNode("div",{id:a.unref(g),class:"widget"},[a.createVNode(S.default,{ref_key:"earthRef",ref:s,style:{height:"100%"},background:e.value.background,"is-background":e.value.isBackground,fog:e.value.fog,"fog-color":e.value.fogColor,"fog-near":e.value.fogNear,"fog-far":e.value.fogFar,stats:e.value.stats,"stats-type":e.value.statsType,radius:e.value.radius,subdivision:e.value.subdivision,animation:e.value.animation,"animation-speed":e.value.animationSpeed,texture:e.value.texture,color:e.value.color,opacity:e.value.opacity,transparent:e.value.transparent,wireframe:e.value.wireframe,label:e.value.label,particle:e.value.particle,"particle-color":e.value.particleColor,"particle-size":e.value.particleSize,aperture:e.value.aperture,"aperture-color":e.value.apertureColor,"aperture-opacity":e.value.apertureOpacity,"aperture-transparent":e.value.apertureTransparent,"aperture-depth-write":e.value.apertureDepthWrite,"cloud-cover":e.value.cloudCover,"cloud-cover-color":e.value.cloudCoverColor,"cloud-cover-opacity":e.value.cloudCoverOpacity,"cloud-cover-transparent":e.value.cloudCoverTransparent,"cloud-cover-animation":e.value.cloudCoverAnimation,"cloud-cover-animation-speed":e.value.cloudCoverAnimationSpeed,"starry-sky":e.value.starrySky,"starry-sky-texture":e.value.starrySkyTexture,"starry-sky-number":e.value.starrySkyNumber,"starry-sky-size":e.value.starrySkySize,"starry-sky-color":e.value.starrySkyColor,"starry-sky-opacity":e.value.starrySkyOpacity,"starry-sky-animation":e.value.starrySkyAnimation,"starry-sky-animation-speed":e.value.starrySkyAnimationSpeed,"ambient-light-color":e.value.ambientLightColor,"ambient-light-intensity":e.value.ambientLightIntensity,"directional-light-x":e.value.directionalLightX,"directional-light-y":e.value.directionalLightY,"directional-light-z":e.value.directionalLightZ,"directional-light-intensity":e.value.directionalLightIntensity,"directional-light-color":e.value.directionalLightColor,"is-composer":e.value.isComposer,composer:e.value.composer,flylines:e.value.flylines,lines:e.value.lines,"light-beam":e.value.lightBeams,onOnSuccess:b},{default:a.withCtx(()=>[e.value.chinaBorderShow?(a.openBlock(),a.createBlock(c.default,{key:0,geojson:"china",color:e.value.chinaBorderColor,width:e.value.chinaBorderWidth,opacity:e.value.chinaBorderOpacity,wakeline:e.value.chinaBorderWakeline,"wakeline-number":e.value.chinaBorderWakelineNumber},null,8,["color","width","opacity","wakeline","wakeline-number"])):a.createCommentVNode("",!0),e.value.china2BorderShow?(a.openBlock(),a.createBlock(c.default,{key:1,geojson:"china-border",color:e.value.china2BorderColor,width:e.value.china2BorderWidth,opacity:e.value.china2BorderOpacity,wakeline:e.value.china2BorderWakeline,"wakeline-number":e.value.china2BorderWakelineNumber},null,8,["color","width","opacity","wakeline","wakeline-number"])):a.createCommentVNode("",!0),e.value.worldBorderShow?(a.openBlock(),a.createBlock(c.default,{key:2,geojson:"world",color:e.value.worldBorderColor,width:e.value.worldBorderWidth,opacity:e.value.worldBorderOpacity,wakeline:e.value.worldBorderWakeline,"wakeline-number":e.value.worldBorderWakelineNumber},null,8,["color","width","opacity","wakeline","wakeline-number"])):a.createCommentVNode("",!0)]),_:1},8,["background","is-background","fog","fog-color","fog-near","fog-far","stats","stats-type","radius","subdivision","animation","animation-speed","texture","color","opacity","transparent","wireframe","label","particle","particle-color","particle-size","aperture","aperture-color","aperture-opacity","aperture-transparent","aperture-depth-write","cloud-cover","cloud-cover-color","cloud-cover-opacity","cloud-cover-transparent","cloud-cover-animation","cloud-cover-animation-speed","starry-sky","starry-sky-texture","starry-sky-number","starry-sky-size","starry-sky-color","starry-sky-opacity","starry-sky-animation","starry-sky-animation-speed","ambient-light-color","ambient-light-intensity","directional-light-x","directional-light-y","directional-light-z","directional-light-intensity","directional-light-color","is-composer","composer","flylines","lines","light-beam"])],8,C)]))}});exports.default=x;
