"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),v=require("lodash"),p=require("flv.js"),s=require("../../commons/plugins/event/index.js"),O=["poster","autoplay","controls","loop","muted"],H=t.defineComponent({name:"zv-media-flv"}),J=t.defineComponent({...H,props:{basicOption:{},sources:{},useEvents:{}},emits:["on-video-progress","on-video-play","on-video-pause","on-video-ended","on-video-playing","on-video-timeupdate","on-video-error","on-video-volumechange"],setup(l,{expose:u,emit:c}){const e=l,E=()=>{const o=t.ref(),a=d=>{if(d&&p.isSupported())try{const r=p.createPlayer({type:"flv",url:d});r.attachMediaElement(o.value),r.load(),e.basicOption.autoplay&&r.play()}catch{}};return t.onMounted(()=>a(e.basicOption.src)),{videoRef:o,initFlvVideo:a}},{videoRef:i,initFlvVideo:m}=E();t.watch(()=>v.cloneDeep(e.basicOption),(o,a)=>{v.isEqual(o,a)||m(o.src)},{deep:!0});const n=c,y=()=>{n("on-video-progress"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-progress")},f=()=>{n("on-video-play"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-play")},P=()=>{n("on-video-pause"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-pause")},g=()=>{n("on-video-ended"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-ended")},V=()=>{n("on-video-playing"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-playing")},b=()=>{n("on-video-timeupdate"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-timeupdate")},h=()=>{n("on-video-error"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-error")},S=()=>{n("on-video-volumechange"),s.SHJParseEvent.parseEvents(e.useEvents,"on-video-volumechange")};return u({play:()=>{i.value&&i.value.play()},pause:()=>{i.value&&i.value.pause()}}),(o,a)=>(t.openBlock(),t.createElementBlock("video",{ref_key:"videoRef",ref:i,class:"zerov-widget",poster:o.basicOption.poster,autoplay:o.basicOption.autoplay,controls:o.basicOption.controls,loop:o.basicOption.loop,muted:o.basicOption.muted,onProgress:y,onPlay:f,onEnded:g,onPlaying:V,onPause:P,onTimeupdate:b,onError:h,onVolumechange:S},null,40,O))}});exports.default=J;
