"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),d=require("lodash"),V=require("vue3-seamless-scroll"),f=require("nanoid"),M=require("../../commons/plugins/datasource/index.js"),u=require("../../commons/plugins/event/index.js"),q=["onClick","onMouseenter","onMouseout"],D=["onClick"],H={key:1},W=t.defineComponent({name:"zv-text-table-scroll"}),J=t.defineComponent({...W,props:{basicOption:{},useEvents:{},sources:{},uuid:{}},emits:["on-click-item","on-click-row","on-mouseenter-row","on-mouseout-row"],setup(O,{expose:y,emit:g}){t.useCssVars(e=>({"0811a92e":e.basicOption.css.table.borderWidth+"px","71192c8f":e.basicOption.css.table.borderStyle,"70353e41":e.basicOption.css.table.borderColor,"1e63deeb":e.basicOption.css.table.paddingLeft+"px","2e35a6d1":e.basicOption.css.table.alignItems,"74e58fdf":e.basicOption.css.table.justifyContent,"178770f9":e.basicOption.css.header.background,"0ad199db":e.basicOption.css.header.height+"px","277abe90":e.basicOption.css.header.color,"8469b69c":e.basicOption.css.header.fontSize+"px","3b289f72":e.basicOption.css.header.fontWeight,"01b73977":e.basicOption.css.header.fontStyle,"6e203544":e.basicOption.css.body.background,bd0c22f2:e.basicOption.css.oddBackground,"20ed198d":e.basicOption.css.body.color,"87ef5172":e.basicOption.css.body.fontSize+"px",dc7d3886:e.basicOption.css.body.fontWeight,"781f3fcc":e.basicOption.css.body.fontStyle}));const p=g,m=t.ref(f.nanoid()),i=t.ref([]),s=O,b=t.ref(s.basicOption.scroll.start),a=()=>{M.SHJDatasourceV2.parse({tId:s.uuid,sources:s.sources,callback:e=>{try{u.SHJParseEvent.parseEvents(s.useEvents,"dataListener",i),i.value=d.cloneDeep(e.data[0].data)||[],m.value=f.nanoid(),b.value=s.basicOption.scroll.start}catch{u.SHJParseEvent.parseEvents(s.useEvents,"dataListener",null),m.value=f.nanoid(),i.value=[],b.value=s.basicOption.scroll.start}}})},E=e=>{const o=[];for(const n in e)o.push(e[n]);return o};t.onMounted(()=>a()),t.watch(()=>d.cloneDeep(s.basicOption),(e,o)=>{d.isEqual(e,o)||a()},{deep:!0}),t.watch(()=>d.cloneDeep(s.sources),(e,o)=>{d.isEqual(e,o)||a()},{deep:!0}),y({refresh:()=>a(),refreshView:()=>a(),refreshData:()=>a()});const S=e=>{if(!s.basicOption.columns)return!0;const o=s.basicOption.columns.find(n=>n.index===e);return o?o.font.auto:!0},h=e=>{if(!s.basicOption.columns)return null;const o=s.basicOption.columns.find(n=>n.index===e);return o&&o.font.auto===!1?o.font:null},v=e=>{if(!s.basicOption.columns)return!0;const o=s.basicOption.columns.find(n=>n.index===e);return o?o.width.auto:!0},k=e=>{if(!s.basicOption.columns)return null;const o=s.basicOption.columns.find(n=>n.index===e);return o&&o.width.auto===!1?o.width.width:null},w=(e,o)=>{const n={row:e,rowIndex:o};p("on-click-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-click-row",n)},C=(e,o)=>{const n={row:e,rowIndex:o};p("on-mouseenter-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-mouseenter-row",n)},B=(e,o)=>{const n={row:e,rowIndex:o};p("on-mouseout-row",n),u.SHJParseEvent.parseEvents(s.useEvents,"on-mouseout-row",n)},z=(e,o,n,l)=>{const r={row:e,item:o,rowIndex:n,columnIndex:l};p("on-click-item",r),u.SHJParseEvent.parseEvents(s.useEvents,"on-click-item",r)};return(e,o)=>i.value.length>0?(t.openBlock(),t.createElementBlock("div",{key:m.value,class:"table-scroll",style:t.normalizeStyle({lineHeight:e.basicOption.css.body.height+"px"})},[e.basicOption.css.header.show?(t.openBlock(),t.createElementBlock("div",{key:0,class:"table-header",style:t.normalizeStyle({"--header-background-image":`url(${e.basicOption.css.header.backgroundImage})`})},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.keys(i.value[0]),(n,l)=>(t.openBlock(),t.createElementBlock("div",{key:n,class:t.normalizeClass(["th",{customWidth:!v(l+1)}]),style:t.normalizeStyle({"--width":k(l+1)+"px"})},[t.createElementVNode("p",null,t.toDisplayString(n),1)],6))),128))],4)):t.createCommentVNode("",!0),t.createVNode(t.unref(V.Vue3SeamlessScroll),{modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=n=>b.value=n),direction:e.basicOption.scroll.direction,list:i.value,"is-watch":"",step:e.basicOption.scroll.step,hover:e.basicOption.scroll.hover,"limit-scroll-num":e.basicOption.scroll.limitScrollNum,"single-height":e.basicOption.scroll.isSingle?e.basicOption.css.body.height:0,"single-wait-time":e.basicOption.scroll.singleWaitTime,class:"table-body",style:t.normalizeStyle([{color:"red"},{"line-height":"36px"}])},{default:t.withCtx(()=>[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(i.value,(n,l)=>(t.openBlock(),t.createElementBlock("div",{key:n,class:"tr",style:t.normalizeStyle({"--row-hover":e.basicOption.css.hoverColor}),onClick:r=>w(n,l),onMouseenter:r=>C(n,l),onMouseout:r=>B(n,l)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(E(n),(r,c)=>(t.openBlock(),t.createElementBlock("div",{key:r,class:t.normalizeClass(["td",{customWidth:!v(c+1)}]),style:t.normalizeStyle({"--width":k(c+1)+"px"}),onClick:P=>z(n,r,l,c)},[S(c+1)?(t.openBlock(),t.createElementBlock("p",H,t.toDisplayString(r),1)):(t.openBlock(),t.createElementBlock("p",{key:0,class:"customFont",style:t.normalizeStyle({"--text-color":h(c+1).color,"--text-font-size":h(c+1).fontSize+"px","--text-font-style":h(c+1).fontStyle})},t.toDisplayString(r),5))],14,D))),128))],44,q))),128))]),_:1},8,["modelValue","direction","list","step","hover","limit-scroll-num","single-height","single-wait-time"])],4)):t.createCommentVNode("",!0)}});exports.default=J;
