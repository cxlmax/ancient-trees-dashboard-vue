"use strict";var d=Object.defineProperty;var h=(i,e,t)=>e in i?d(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var s=(i,e,t)=>h(i,typeof e!="symbol"?e+"":e,t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=require("three"),f=require("stats.js"),w=require("./label.js");function m(i){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>i[t]})}}return e.default=i,Object.freeze(e)}const r=m(u);class g{constructor(e,t){s(this,"stats");s(this,"scene");s(this,"camera");s(this,"webGlRenderer");s(this,"labelRenderer");s(this,"element");s(this,"animationFrameId",0);s(this,"textures",{});this.element=e,this.scene=this.createScene(t),this.stats=this.createStats(t),this.camera=this.createCamera(this.element),this.webGlRenderer=this.createWebGLRenderer(this.element),window.addEventListener("resize",()=>this.onWindowResize(this.element))}createScene(e){const t=new r.Scene;return e.isBackground?t.background=new r.Color(e.background):t.background=null,e.fog&&(t.fog=new r.Fog(e.fogColor,e.fogNear,e.fogFar)),t}createCamera(e){const t=new r.PerspectiveCamera(45,e.offsetWidth/e.offsetHeight,.1,1e4);return t.position.set(10,10,10),t.lookAt(0,0,0),t}createWebGLRenderer(e){const t=new r.WebGLRenderer({preserveDrawingBuffer:!0,antialias:!0,alpha:!0});return t.setClearAlpha(0),t.setPixelRatio(window.devicePixelRatio),t.autoClear=!1,t.clearColor(),t.setSize(e.offsetWidth,e.offsetHeight),e.appendChild(t.domElement),this.labelRenderer=w.labelRenderer(e),t}createAmbientLight(e){return new r.AmbientLight(new r.Color(e.color),e.intensity)}createDirectionalLight(e){const t=new r.DirectionalLight(new r.Color(e.color),e.intensity);return t.position.set(e.x,e.y,e.z),t.lookAt(0,0,0),t}createGridHelper(e){if(e.show)return new r.GridHelper(e.width,e.height,new r.Color(e.color),new r.Color(e.color))}createAxesHelper(e){if(e.show)return new r.AxesHelper(e.size)}createStats(e){if(e.stats){const t=new f;return t.domElement.style.position="absolute",t.domElement.style.top="5px",t.domElement.style.left="5px",t.showPanel(e.statsType),this.element.appendChild(t.dom),t}return null}resize(){this.webGlRenderer.setSize(this.element.offsetWidth,this.element.offsetHeight),this.camera.aspect=this.element.offsetWidth/this.element.offsetHeight,this.camera.updateProjectionMatrix()}render(){this.animationFrameId=requestAnimationFrame(()=>{this.stats&&this.stats.update(),this.render(),this.webGlRenderer.clear(),this.webGlRenderer.render(this.scene,this.camera)})}add(...e){e.forEach(t=>{t&&this.scene.add(t)})}dispose(){try{cancelAnimationFrame(this.animationFrameId),this.element.innerHTML="",this.camera.clear(),this.webGlRenderer.forceContextLoss(),this.webGlRenderer.dispose(),this.scene.clear()}catch{}}onWindowResize(e){const t=e.offsetWidth,n=e.offsetHeight;this.webGlRenderer.setSize(t,n),this.camera.aspect=t/n,this.camera.updateProjectionMatrix()}loadTextures(e,t){const n=new r.TextureLoader;let o=0;const a=()=>{if(o<e.length){const l=e[o].value;l?n.load(l,c=>{this.textures[e[o].key]=c,o++,a()},void 0,function(c){o++,a()}):(o++,a())}else t(this.textures)};a()}}exports.Scene=g;
