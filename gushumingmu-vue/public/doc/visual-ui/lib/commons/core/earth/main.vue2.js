"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const a=require("vue"),M=require("nanoid"),j=require("lodash"),q=require("./main.js"),D={class:"earth-wrap"},X=["id"],Y=a.defineComponent({__name:"main",props:{isComposer:{type:Boolean,default:!1},radius:{default:50},subdivision:{default:80},color:{default:"#1a1a1a"},opacity:{default:1},transparent:{type:Boolean,default:!0},wireframe:{type:Boolean,default:!1},label:{default:()=>({show:!1,color:"#ffffff",fontSize:8})},texture:{type:[String,Boolean],default:void 0},animation:{type:Boolean,default:!0},animationSpeed:{default:2},background:{default:"#050b16"},isBackground:{type:Boolean,default:!0},fog:{type:Boolean,default:!1},fogColor:{default:"#020924"},fogNear:{default:20},fogFar:{default:50},stats:{type:Boolean,default:!1},statsType:{default:0},aperture:{type:Boolean,default:!1},apertureColor:{default:"#ffffff"},apertureOpacity:{default:.1},apertureTransparent:{type:Boolean,default:!0},apertureDepthWrite:{type:Boolean,default:!1},cloudCover:{type:Boolean,default:!1},cloudCoverColor:{default:"#ffffff"},cloudCoverOpacity:{default:1},cloudCoverTransparent:{type:Boolean,default:!0},cloudCoverTexture:{},cloudCoverAnimation:{type:Boolean,default:!0},cloudCoverAnimationSpeed:{default:3},starrySky:{type:Boolean,default:!1},starrySkyTexture:{default:void 0},starrySkyNumber:{default:1e4},starrySkySize:{default:1},starrySkyColor:{default:"#ffffff"},starrySkyOpacity:{default:1},starrySkyAnimation:{type:Boolean,default:!0},starrySkyAnimationSpeed:{default:1},gridHelper:{type:Boolean,default:!1},gridHelperWidth:{default:500},gridHelperHeight:{default:500},gridHelperColor:{default:"#ffffff"},axesHelper:{type:Boolean,default:!1},axesHelperSize:{default:100},ambientLightColor:{default:"#ffffff"},ambientLightIntensity:{default:.2},directionalLightX:{default:0},directionalLightY:{default:5},directionalLightZ:{default:10},directionalLightIntensity:{default:2},directionalLightColor:{default:"#ffffff"},composer:{default:{unrealBloomPass:{},glitchPass:{},dotScreenPass:{},filmPass:{}}},particle:{type:Boolean,default:!1},particleColor:{default:"#6acadd"},particleSize:{default:5},flylines:{default:()=>[]},lines:{default:()=>[]},lightBeam:{default:()=>[]}},emits:["on-success"],setup(S,{expose:C,emit:v}){const n=M.nanoid(),l=a.useSlots(),t=S,w=a.computed(()=>({background:t.background,isBackground:t.isBackground,fog:t.fog,fogColor:t.fogColor,fogNear:t.fogNear,fogFar:t.fogFar,stats:t.stats,statsType:t.statsType})),B=a.computed(()=>({isComposer:t.isComposer,composer:t.composer})),P=a.computed(()=>({radius:t.radius,subdivision:t.subdivision,animation:t.animation,animationSpeed:t.animationSpeed/1e4,texture:t.texture,color:t.color,opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe,particle:t.particle,particleColor:t.particleColor,particleSize:t.particleSize,label:t.label})),k=a.computed(()=>({show:t.aperture,color:t.apertureColor,opacity:t.apertureOpacity,transparent:t.apertureTransparent,depthWrite:t.apertureDepthWrite})),L=a.computed(()=>({show:t.cloudCover,color:t.cloudCoverColor,opacity:t.cloudCoverOpacity,transparent:t.cloudCoverTransparent,animation:t.cloudCoverAnimation,animationSpeed:t.cloudCoverAnimationSpeed/1e4})),b=a.computed(()=>({show:t.starrySky,texture:t.starrySkyTexture,number:t.starrySkyNumber,size:t.starrySkySize,color:t.starrySkyColor,opacity:t.starrySkyOpacity,animation:t.starrySkyAnimation,animationSpeed:t.starrySkyAnimationSpeed/1e4})),z=a.computed(()=>({color:t.ambientLightColor,intensity:t.ambientLightIntensity})),H=a.computed(()=>({x:t.directionalLightX,y:t.directionalLightY,z:t.directionalLightZ,intensity:t.directionalLightIntensity,color:t.directionalLightColor})),T=a.computed(()=>({sceneParameter:w.value,earthParameter:P.value,apertureParameter:k.value,cloudCoverParameter:L.value,starrySkyParameter:b.value,gridHelperParameter:{show:t.gridHelper,width:t.gridHelperWidth,height:t.gridHelperHeight,color:t.gridHelperColor},axesHelperParameter:{show:t.axesHelper,size:t.axesHelperSize},ambientLightParameter:z.value,directionalLightParameter:H.value,composerParameter:B.value})),x=v;let r;const E=()=>new Promise(o=>{new q.Earth(document.getElementById(n),T.value).start().then(e=>{r=e,o(e)})}),O=async()=>{F("th-earth-border").forEach(async e=>{var c,f,d,u,p,y,m,h,g;const i=((c=e.props)==null?void 0:c.geojson)||e.type.props.geojson.default,W={color:((f=e.props)==null?void 0:f.color)||e.type.props.color.default,lineWidth:((d=e.props)==null?void 0:d.width)===void 0?e.type.props.width.default:(u=e.props)==null?void 0:u.width,opacity:((p=e.props)==null?void 0:p.opacity)||e.type.props.opacity.default,wakeline:((y=e.props)==null?void 0:y.wakeline)===void 0?e.type.props.wakeline.default:(m=e.props)==null?void 0:m.wakeline,wakelineNumber:((h=e.props)==null?void 0:h.wakelineNumber)===void 0?e.type.props.wakelineNumber.default:(g=e.props)==null?void 0:g.wakelineNumber},I=await r.createMapBorder(i,W);r.earth.add(I)})},_=()=>{(t.lines||[]).forEach(e=>{e.data&&r.earth.add(r.createFlightLines(e.data,{labelParameter:{show:e.labelShow||!1,color:e.labelColor||"#ffffff",fontSize:e.labelFontSize||12},lineParameter:{color:e.color||"#ffffff",lineWidth:e.width||1,opacity:e.opacity||1},startScatterParameter:{color:e.startScatterColor||"#fff111",size:e.startScatterSize||8,opacity:e.startScatterOpacity||1},endScatterParameter:{color:e.endScatterColor||"#fff111",size:e.endScatterSize||10,opacity:e.endScatterOpacity||1}}))})},N=async()=>{const o=t.flylines||[];for await(const e of o)e.data&&r.createFlyLines(e.data,{labelParameter:{show:e.labelShow||!1,color:e.labelColor||"#ffffff",fontSize:e.labelFontSize||12},lineParameter:{color:e.color||"",number:e.number||1,speed:e.speed||1,length:e.length||.5,size:e.size||1},bgLineParameter:{show:e.bgLineShow,opacity:e.bgLineOpacity||.2,color:e.bgLineColor||"#cccccc",segments:e.bgLineSegments||8,radius:e.bgLineRadius||.02},startScatterParameter:{color:e.startScatterColor||"#fff111",size:e.startScatterSize||8,opacity:e.startScatterOpacity||1},endScatterParameter:{color:e.endScatterColor||"#fff111",size:e.endScatterSize||10,opacity:e.endScatterOpacity||1}}).then(i=>{r.earth.add(i)})},A=()=>{(t.lightBeam||[]).forEach(e=>{e.data&&r.createLightBeamScatter(e.data,{scatterParameter:{color:e.color||"#ffffff",opacity:e.opacity||1,size:e.scatterSize||10},lightBeamParameter:{type:e.type||1,color:e.color||"#ffffff",opacity:e.opacity||1,radius:e.beamSize||.2,baseHeight:e.baseHeight||.02}}).then(i=>{r.earth.add(i)})})},s=async()=>{const o=document.getElementById(n);o&&o.classList.remove("showLabel"),E().then(e=>{setTimeout(async()=>{await O(),await _(),await N(),await A(),await x("on-success"),r.accessAnimation().then(i=>{o&&o.classList.add("showLabel")})},300)})};a.onMounted(()=>s()),C({dispose:()=>{r&&r.dispose()},refresh:j.debounce(()=>{r&&r.dispose(),setTimeout(()=>s())},100)}),a.onBeforeUnmount(()=>{r&&r.dispose()});const F=o=>(l==null?void 0:l.default)===void 0?[]:l==null?void 0:l.default().map(e=>{var i;return((i=e.type)==null?void 0:i.name)===o?e:!1}).filter(e=>e!==!1);return(o,e)=>(a.openBlock(),a.createElementBlock("div",D,[a.createElementVNode("div",{id:a.unref(n),class:"zv-earth"},[a.renderSlot(o.$slots,"default",{},void 0,!0)],8,X)]))}});exports.default=Y;
