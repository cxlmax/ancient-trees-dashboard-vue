"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("../index.js"),u=require("../utils/request.js"),t=require("../utils/utils.js"),E=(l,a,b)=>new Promise(function(r,T){const{api:s}=l.source;try{if(s){let{isHeaders:D,isBody:h,headers:c,contentType:S,url:e,postParam:n}=s;const y=t.DataSourceUtils.getEnvironments(),p=t.DataSourceUtils.getVariableData(),i=q=>{q.then(U=>{if(U.status===200){const{filter:P,mapping:g}=l.source;m.SHJDatasourceV2.processData(P,U.data,g,a,l.source.dynamicMapping,b).then(f=>{f&&r(f)}).catch(()=>r(t.DataSourceUtils.noneData(a)));return}r(t.DataSourceUtils.noneData(a))}).catch(()=>{r(t.DataSourceUtils.noneData(a))})},o=t.DataSourceUtils.replaceEnvVariables(e,y);e=t.DataSourceUtils.replaceURLVariables(e,p),h&&(n=t.DataSourceUtils.replaceObjectVariables(n,p)),D&&(c=t.DataSourceUtils.replaceObjectVariables(c,p)),s.type==="GET"&&i(u.httpRequest.get(o+e,{headers:c})),s.type==="POST"&&i(u.httpRequest.post(o+e,n,{headers:c},S)),s.type==="PUT"&&i(u.httpRequest.put(o+e,n,{headers:c},S)),s.type==="DELETE"&&i(u.httpRequest.delete(o+e,{headers:c}))}else r(t.DataSourceUtils.noneData(a))}catch{r(t.DataSourceUtils.noneData(a))}});exports.parseAPIPort=E;
